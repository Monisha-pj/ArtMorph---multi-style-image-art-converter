<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ArtMorph â€” Cute Studio</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@500;600&family=Handlee&display=swap');

body{
  font-family:'Quicksand',sans-serif;
  background:linear-gradient(120deg,#ffeaf5,#e4d8ff,#c8f1ff);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:40px;
}

.container{
  background:rgba(255,255,255,0.65);
  backdrop-filter:blur(15px);
  border-radius:25px;
  box-shadow:0 8px 30px rgba(170,120,255,0.25);
  padding:30px;
  width:95%;
  max-width:1100px;
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:25px;
  border:1px solid rgba(255,255,255,0.4);
}

@media(max-width:950px){.container{grid-template-columns:1fr;}}

h1{
  font-family:'Handlee',cursive;
  font-size:2rem;
  text-align:center;
  background:linear-gradient(90deg,#ff9fcf,#b088ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:8px;
}

p.lead{
  color:#7a4e91;
  font-size:0.9rem;
  text-align:center;
  margin-bottom:15px;
}

.panel{
  background:rgba(255,255,255,0.55);
  border-radius:20px;
  padding:20px;
  box-shadow:0 3px 12px rgba(0,0,0,0.05);
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  align-items:center;
}

.upload-line{
  display:flex;
  justify-content:space-between;
  align-items:center;
  width:100%;
  margin-bottom:10px;
}

label.custom-file{
  background:linear-gradient(90deg,#ffb5d1,#b088ff);
  padding:10px 18px;
  border-radius:15px 40px 15px 40px; /* creative curve */
  color:#fff;
  cursor:pointer;
  font-weight:600;
  box-shadow:0 4px 12px rgba(176,136,255,0.4);
  white-space:nowrap;
  transition:all 0.25s ease;
}
label.custom-file:hover{transform:scale(1.05);}

input[type=file]{display:none;}
#fileInfo{
  color:#7a4e91;
  font-size:0.9rem;
  margin-left:10px;
}

.style-section{
  width:100%;
  margin-top:10px;
}
.style-section label{
  display:block;
  text-align:left;
  font-weight:600;
  color:#5e2a84;
  margin-bottom:6px;
}

#styles{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
  justify-items:start;
}

.style-btn {
  position: relative;
  background: linear-gradient(135deg, #ffffff 0%, #fbefff 40%, #e5d8ff 100%);
  border: none;
  padding: 14px 28px;
  border-radius: 40px;
  font-weight: 600;
  color: #5e2a84;
  cursor: pointer;
  font-family: 'Quicksand', sans-serif;
  box-shadow:
    inset 0 2px 6px rgba(255, 255, 255, 0.8),
    0 6px 12px rgba(190, 150, 255, 0.25);
  transition: all 0.3s ease;
}

/* cloud puff effect */
/* .style-btn::before,
.style-btn::after {
  content: "";
  position: absolute;
  background: inherit;
  border-radius: 50%;
  z-index: -1;
  transition: all 0.3s ease;
}

.style-btn::before {
  width: 26px;
  height: 26px;
  top: -12px;
  left: 10px;
}

.style-btn::after {
  width: 32px;
  height: 32px;
  top: -16px;
  right: 12px;
} */

.style-btn:hover {
  transform: translateY(-3px);
  background: linear-gradient(135deg, #ffcaf3 0%, #d8b8ff 100%);
  color: #fff;
  box-shadow:
    0 8px 16px rgba(176, 136, 255, 0.35),
    inset 0 2px 8px rgba(255, 255, 255, 0.8);
}

.style-btn.active {
  background: linear-gradient(135deg, #ffb7e8 0%, #b088ff 100%);
  color: #fff;
  box-shadow: 0 0 15px rgba(176, 136, 255, 0.6);
}

.preview-box {
  background: rgba(255, 255, 255, 0.6);
  border-radius: 25px; /* slightly more curve for softer edges */
  width: 100%;
  height: 320px; /* fixed height for both preview and result */
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-shadow:
    inset 0 0 10px rgba(0, 0, 0, 0.05),
    0 0 12px rgba(176, 136, 255, 0.15);
  transition: all 0.3s ease;
}

.preview-box:hover {
  transform: scale(1.02);
  box-shadow:
    0 0 20px rgba(176, 136, 255, 0.25),
    inset 0 0 12px rgba(255, 255, 255, 0.8);
}

.preview-box img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 25px; /* matches the box curve */
  transition: all 0.3s ease;
}



button{
  border:none;
  border-radius:15px;
  padding:8px 14px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s ease;
}
#convertBtn{
  background:linear-gradient(90deg,#ff9fcf,#b088ff);
  color:#fff;
}
#resetBtn{
  background:#fff;
  color:#b088ff;
  border:2px solid #b088ff;
}
.download-btn{
  display:none;
  margin-top:10px;
  background:linear-gradient(90deg,#ff9fcf,#b088ff);
  color:#fff;
}
.footer-note{
  font-size:0.8rem;
  color:#7a4e91;
  text-align:center;
  margin-top:15px;
}
</style>
</head>
<body>

<div class="container">
  <!-- Panel 1 -->
  <div class="panel">
    <h1>ðŸŒ¸ ArtMorph</h1>
    <p class="lead">Turn your photo into dreamy art â€” sketch, watercolor, cartoon, or pixel style!</p>
      <br>
    <form id="uploadForm">
      <div class="upload-line">
        <label for="fileInput" class="custom-file">Choose Image</label>
        <p id="fileInfo">No file selected</p>
      </div>
      <input id="fileInput" type="file" accept="image/*" required>
        <br>
      <div class="style-section">
        <label>Select Style:</label>
          <br>
        <div id="styles">
          <button type="button" class="style-btn active" data-style="sketch">Sketch</button>
          <button type="button" class="style-btn" data-style="watercolor">Watercolor</button>
          <button type="button" class="style-btn" data-style="cartoon">Cartoon</button>
          <button type="button" class="style-btn" data-style="pixel">Pixel</button>
        </div>
      </div>
      <br>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:15px;">
        <button id="convertBtn" type="submit">Convert </button>
        <button id="resetBtn" type="button">Reset </button>
      </div>
    </form>
  </div>

  <!-- Panel 2 -->
  <div class="panel">
    <h3 style="color:#5e2a84;">Preview</h3>
    <div class="preview-box" id="previewBox">
      <p id="placeholder" style="color:#7a4e91;text-align:center;font-size:0.9rem;">Your uploaded image will appear here</p>
      <img id="srcPreview" style="display:none;">
    </div>
  </div>

  <!-- Panel 3 -->
  <div class="panel">
    <h3 style="color:#5e2a84;">Result</h3>
    <div class="preview-box">
      <img id="resultImg" style="display:none;">
    </div>
    <button id="downloadBtn" class="download-btn">Download</button>
    <p class="footer-note">Tip: Use bright, clear images for the most magical look âœ¨</p>
  </div>
</div>

<script>
const fileInput=document.getElementById("fileInput");
const fileInfo=document.getElementById("fileInfo");
const srcPreview=document.getElementById("srcPreview");
const resultImg=document.getElementById("resultImg");
const styles=document.getElementById("styles");
const convertBtn=document.getElementById("convertBtn");
const downloadBtn=document.getElementById("downloadBtn");
const resetBtn=document.getElementById("resetBtn");
const uploadForm=document.getElementById("uploadForm");
let selectedStyle="sketch",lastResultBlob=null;

styles.addEventListener("click",e=>{
 const btn=e.target.closest(".style-btn");if(!btn)return;
 styles.querySelectorAll(".style-btn").forEach(b=>b.classList.remove("active"));
 btn.classList.add("active");selectedStyle=btn.dataset.style;
});

// fileInput.addEventListener("change",()=>{
//  const file=fileInput.files[0];if(!file)return;
//  fileInfo.textContent=file.name+" ("+Math.round(file.size/1024)+" KB)";
//  const url=URL.createObjectURL(file);
//  srcPreview.src=url;srcPreview.style.display="block";
//  document.getElementById("placeholder").style.display="none";
//  resultImg.style.display="none";downloadBtn.style.display="none";
// });
fileInput.addEventListener("change",()=>{
 const file=fileInput.files[0];
 if(!file)return;
 fileInfo.textContent=file.name+" ("+Math.round(file.size/1024)+" KB)";
 const url=URL.createObjectURL(file);
 srcPreview.src=url;
 srcPreview.style.display="block";
//  srcPreview.style.maxWidth="480px";   // limit width to fit card
//  srcPreview.style.maxHeight="280px";  // limit height to fit layout
//  srcPreview.style.borderRadius="18px"; // smooth rounded edges to match UI
//  srcPreview.style.objectFit="contain"; // keep full image visible
 document.getElementById("placeholder").style.display="none";
 resultImg.style.display="none";
 downloadBtn.style.display="none";
});

uploadForm.addEventListener("submit",async e=>{
 e.preventDefault();const file=fileInput.files[0];
 if(!file){alert("Please select an image!");return;}
 convertBtn.disabled=true;convertBtn.textContent="Converting...";
 try{
  const fd=new FormData();fd.append("image",file);fd.append("style",selectedStyle);
  const resp=await fetch("/api/convert",{method:"POST",body:fd});
  if(!resp.ok)throw new Error("Server returned "+resp.status);
  const blob=await resp.blob();lastResultBlob=URL.createObjectURL(blob);
  resultImg.src=lastResultBlob;resultImg.style.display="block";downloadBtn.style.display="inline-block";
  downloadBtn.onclick=()=>{const a=document.createElement("a");a.href=lastResultBlob;a.download="artified-"+(file.name||"result.png");a.click();};
 }catch(err){alert("Error: "+err.message);}
 finally{convertBtn.disabled=false;convertBtn.textContent="Convert âœ¨";}
});

resetBtn.addEventListener("click",()=>{
 uploadForm.reset();fileInfo.textContent="No file selected";
 srcPreview.style.display="none";resultImg.style.display="none";downloadBtn.style.display="none";
 document.getElementById("placeholder").style.display="block";
 styles.querySelectorAll(".style-btn").forEach(b=>b.classList.remove("active"));
 styles.querySelector(".style-btn[data-style='sketch']").classList.add("active");selectedStyle="sketch";
 if(lastResultBlob)URL.revokeObjectURL(lastResultBlob);
});
</script>

</body>
</html>
